<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1671.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">Sub Stock_Analysis():</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim total As Double</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim i As Long</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim change As Double</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim j As Integer</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim start As Long</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim rowCount As Long</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim percentChange As Double</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim days As Integer</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim dailyChange As Double</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim averageChange As Double</p>
<p class="p1"><span class="Apple-converted-space">    </span>Dim ws As Worksheet</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1">For Each ws In Worksheets</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">   </span>ws.Range("I1").Value = "Ticker"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("J1").Value = "Yearly Change"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("K1").Value = "Percent Change"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("L1").Value = "Total Stock Volume"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("P1").Value = "Ticker"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("Q1").Value = "Value"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("O2").Value = "Greatest % Increase"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("O3").Value = "Greatest % Decrease"</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("O4").Value = "Greatest Total Volume"</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>j = 0</p>
<p class="p1"><span class="Apple-converted-space">    </span>total = 0</p>
<p class="p1"><span class="Apple-converted-space">    </span>change = 0</p>
<p class="p1"><span class="Apple-converted-space">    </span>start = 2</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>rowCount = ws.Cells(Rows.Count, "A").End(xlUp).Row</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>For i = 2 To rowCount</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">     </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>If ws.Cells(i + 1, 1).Value &lt;&gt; Cells(i, 1).Value Then</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">       </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>total = total + ws.Cells(i, 7).Value</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">  </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>If total = 0 Then</p>
<p class="p2"><span class="Apple-converted-space">               </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("I" &amp; 2 + j).Value = ws.Cells(i, 1).Value</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("J" &amp; 2 + j).Value = 0</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("K" &amp; 2 + j).Value = "%" &amp; 0</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("L" &amp; 2 + j).Value = 0</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>Else</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>If ws.Cells(start, 3) = 0 Then</p>
<p class="p1"><span class="Apple-converted-space">                    </span>For find_value = start To i</p>
<p class="p1"><span class="Apple-converted-space">                        </span>If ws.Cells(find_value, 3).Value &lt;&gt; 0 Then</p>
<p class="p1"><span class="Apple-converted-space">                            </span>start = find_value</p>
<p class="p1"><span class="Apple-converted-space">                            </span>Exit For</p>
<p class="p1"><span class="Apple-converted-space">                        </span>End If</p>
<p class="p1"><span class="Apple-converted-space">                     </span>Next find_value</p>
<p class="p1"><span class="Apple-converted-space">                </span>End If</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">              </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>change = (ws.Cells(i, 6) - ws.Cells(start, 3))</p>
<p class="p1"><span class="Apple-converted-space">                </span>percentChange = change / ws.Cells(start, 3)</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">              </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>start = i + 1</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("I" &amp; 2 + j).Value = ws.Cells(i, 1).Value</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("J" &amp; 2 + j).Value = change</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("J" &amp; 2 + j).NumberFormat = "0.00"</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("K" &amp; 2 + j).Value = percentChange</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("K" &amp; 2 + j).NumberFormat = "0.00%"</p>
<p class="p1"><span class="Apple-converted-space">                </span>ws.Range("L" &amp; 2 + j).Value = total</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">               </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>Select Case change</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Case Is &gt; 0</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ws.Range("J" &amp; 2 + j).Interior.ColorIndex = 4</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Case Is &lt; 0</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ws.Range("J" &amp; 2 + j).Interior.ColorIndex = 3</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Case Else</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ws.Range("J" &amp; 2 + j).Interior.ColorIndex = 0</p>
<p class="p1"><span class="Apple-converted-space">                </span>End Select</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>End If</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>total = 0</p>
<p class="p1"><span class="Apple-converted-space">            </span>change = 0</p>
<p class="p1"><span class="Apple-converted-space">            </span>j = j + 1</p>
<p class="p1"><span class="Apple-converted-space">            </span>days = 0</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>Else</p>
<p class="p1"><span class="Apple-converted-space">            </span>total = total + ws.Cells(i, 7).Value</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>End If</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>Next i</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">   </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("Q2") = "%" &amp; WorksheetFunction.Max(ws.Range("K2:K" &amp; rowCount)) * 100</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("Q3") = "%" &amp; WorksheetFunction.Min(ws.Range("K2:K" &amp; rowCount)) * 100</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("Q4") = WorksheetFunction.Max(Range("L2:L" &amp; rowCount))</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">   </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>increase_number = WorksheetFunction.Match(WorksheetFunction.Max(ws.Range("K2:K" &amp; rowCount)), ws.Range("K2:K" &amp; rowCount), 0)</p>
<p class="p1"><span class="Apple-converted-space">    </span>decrease_number = WorksheetFunction.Match(WorksheetFunction.Min(ws.Range("K2:K" &amp; rowCount)), ws.Range("K2:K" &amp; rowCount), 0)</p>
<p class="p1"><span class="Apple-converted-space">    </span>volume_number = WorksheetFunction.Match(WorksheetFunction.Max(ws.Range("L2:L" &amp; rowCount)), ws.Range("L2:L" &amp; rowCount), 0)</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("P2") = ws.Cells(increase_number + 1, 9)</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("P3") = ws.Cells(decrease_number + 1, 9)</p>
<p class="p1"><span class="Apple-converted-space">    </span>ws.Range("P4") = ws.Cells(volume_number + 1, 9)</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1">Next ws</p>
<p class="p2"><span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p1">End Sub</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
</body>
</html>
